#!/bin/bash
set -euo pipefail

echo "ðŸ”§ BinderHub postBuild setup for LDaCA Web Application..."

# Ensure all files are executable
chmod +x /usr/local/bin/start-ldaca.sh
chmod +x /usr/local/bin/start-notebook.sh
chmod +x /usr/local/bin/jupyterhub-singleuser

# Create symlinks for easier access
ln -sf /app/ldaca_web_app ${HOME}/ldaca_web_app

# Create a simple index page to redirect to the app
cat > ${HOME}/index.html << 'EOF'
<!DOCTYPE html>
<html>
<head>
    <title>LDaCA - Redirecting...</title>
    <meta http-equiv="refresh" content="0; url=/proxy/8080/">
</head>
<body>
    <h1>ðŸš€ Starting LDaCA Application...</h1>
    <p>You will be redirected automatically. If not, <a href="/proxy/8080/">click here</a>.</p>
</body>
</html>
EOF

echo "âœ… BinderHub setup complete - will serve LDaCA web application!"
